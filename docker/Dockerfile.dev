FROM ubuntu:22.04

ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update && apt-get install -y \
    build-essential cmake git clang clang-format clang-tidy \
    valgrind python3 python3-pip wget lcov \
    libgtest-dev pkg-config

# Attempt to build and install google test libs to /usr/lib
RUN cd /usr/src/gtest && cmake . && make && cp *.a /usr/lib || true

WORKDIR /workspace
COPY . /workspace

CMD ["/bin/bash"]